<div class="headline">
  <h1>
    <%= t('.title') %>
    <small><%= item_multiplicity(@item.multiplicity) %></small>
  </h1>
</div>

<div class="col-md-2 col-sm-12">
  <%= link_to(t('.all_items'), admin_items_path, class: 'btn secondary') %>
  <%= link_to(t('.destroy'), admin_item_path(@item), method: :delete,
                                                      class: 'btn danger') %>
</div>

<div class="col-md-10 col-sm-12">
  <%= render('form', item: @item) %>
</div>

<div class="headline">
  <h2><%= t('.sub_items') %></h2>
</div>

<% if @item.single? %>
  <%= button_to(t('.allow_multiple'), admin_item_path(@item), method: :patch,
                params: { item: { multiplicity: :multiple } },
                class: 'btn primary') %>
<% elsif @item.multiple? %>
  <div class="col-md-2 col-sm-12">
    <%= link_to(t('.new_sub_item'), new_admin_item_sub_item_path(@item),
                                    class: 'btn secondary') %>
    <%= button_to(t('.allow_single'), admin_item_path(@item), method: :patch,
                  params: { item: { multiplicity: :single } },
                  class: 'btn secondary') %>
  </div>

  <div class="col-md-10 col-sm-12">
    <table class="table table-striped table-bordered admin-grid">
      <thead>
        <tr>
          <th><%= Item.human_attribute_name(:title) %></th>
          <th><%= t(:remove) %></th>
        </tr>
      </thead>
      <tbody>
        <% @item.sub_items.each do |sub_item| %>
          <tr id="<%= dom_id(sub_item) %>"
              class="<%= sub_item.current? ? 'highlight' : 'no-highlight' %>">
            <td>
              <%= link_to(sub_item,
                            edit_admin_item_sub_item_path(@item, sub_item)) %>
            </td>
            <td>
              <%= link_to(t(:remove), admin_item_sub_item_path(@item, sub_item),
                          method: :delete,
                          data: { confirm: t('.confirm_remove_sub_item',
                                             title: sub_item.title) }) %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>
